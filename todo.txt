* finish all main points of network code and process logic
- est 2.5 weeks FT

* Read database management systems chapter 5
* finish all main points of Resolver One view + WPF graphing, including GBM forecasting
- est 2.5 weeks full time

* read parts of algorithms book
* do algorithms bit
- est 2.5 weeks full time

- ideas about database normalisation and tuning - est 1 week FT
- ideas about optimisation problem - est 1.5 weeks FT
- ideas from "ideas removed" file - infinite

////

right now:
- read WCF chapter in more detail
- make network serialization methods work
- client/server threads should store the id of the process they are connected to, where applicable, this info will be need with certain message types. for this to work, first messages sent on opening of new connection should be server synchronous message "hey, this is my id" and client synchronous response "hey, this is mine". then needs to be stored in a class somewhere.



- make traders send bank a bunch of test data, and make bank insert it into db
- write tests for multihead queue

- format for Bank broadcast to trader
a) "buyconfirm,traderpacketid,warehouseid", sent to only one client
b) "futuresettle,traderpacketid,warehouseid", sent to only one client

- format for FateAndGuesswork broadcast to Trader, something like:
a) "surplus,portid,commodid,1200,2010-04-15T20:10:00", sent to only one client
b) "shortage,portid,commodid,1200,2010-04-15T20:10:00", sent to only one client

-format for FateAndGuesswork broadcast to Bank, something like:
a) stock price
b) commod price

- format traders to shipping companies something like:
a) "advertise,warehouseid", sent to only one client, also client tcp thread needs to note id of sender
b) "accept,warehouseid", sent to only one client, also client tcp thread needs to note id of sender

- format from trader to bank something like:
a) "buy,madeuppacketid,portid,commodid,quantity", also server tcp thread needs to note id of sender
b) "future,madeuppacketid,portid,commodid,quantity,when", also server tcp thread needs to note id of sender

- format from shipping company to bank something like:
a) "departure,warehouseid,depaturetime", also server tcp thread needs to note id of sender
b) "arrival,warehouseid,arrivaltime", also server tcp thread needs to note id of sender

- format for messages from shipping company to traders something like:
a) "accept,warehouseid", sent to only one client, also server tcp thread needs to note id of sender

////

Process logic and networking:
- Trader/ShippingCompany interaction: delay of 5 secs between receiving acceptance of contract for movement of goods and taking contract off broadcast, requiring system of acks and locks
- make sure everything from outline_system_plan.txt is working.
Unit test individual functions
- mega_start.bat script to start all C# processes at once, including algoserver (not Resolver though)
- probably use sql spatial functions to work out distances for freighter travel - both for Bank and for Resolver

///

First two tabs of Resolver sheet (GBM data streams):
- make the basic update buttons work correctly
- Brownian random walk predicted future graph - present data as a solid line, then a bunch of dashed lines for various possibilities. This is mutually exclusive with constant update - pressing one deletes data from the other, perhaps, or maybe disable button.
Need to save a variable which says how many of the rows are real data, then this row is sent to brownian graph so it knows from where to draw dashed line.
- make percentageDrift and percentageVolatility editable on spreadsheet, and different for currencies + commods

brownian motion random walking:
I need to sample random distib. use my tiny statslib for both resolver and economicplayer.

other people doing similar things:
http://www.scipy.org/Cookbook/BrownianMotion
the black-scholes R1 sheet
http://en.wikipedia.org/wiki/Geometric_Brownian_motion
http://en.wikipedia.org/wiki/Wiener_process	
also:
http://www.scipy.org/Cookbook/FittingData

I think this is right:

- change_in_price = PERCENTAGE_DRIFT * prev_price + PERCENTAGE_VOLATILITY * prev_price * change_in_wiener_process
- make Wt a random variable chosen from a normal distribution with mean 0 and standard deviation equal to tick time


- WPF graph program. Should have ability to create new windows, or add new data to current windows, also has option for real time update.
- graph windows to include help instructions
- maybe mention my thoughts on benefits of selective timed functions vs recalcualting whole workbook with RecalculateAfter

/////

Next two sheets:
4. Historical futures contracts, including details of how relevant prices of all involved values changed between start and end of contract, and profit made (CU)
5. Historical commdity transports, including details of how relevant prices of all involved values changed between start and end of contract, and profit made (CU)

Thirdly, summary data sets:
6. Summary data on comparative historical record of countries, split into time periods
Drop down to select country
- name of country's currency
in each time period have
- number of and total value of buys
- number and total value of settled futures
- overall outgoings, overall income, overall profit/loss
- number of futures agreed in period
- average diff between futures settled price in period and price they were agreed at
- average value of currency vs USD

7. Summary data for each shipping company, split into time periods
Drop down to select company
- name of company's country, and its currency
For each time period, have:
- number of different ports served
- average quantity per load
- min quantity in a single load
- max quantity in a single load
- av share price (own currency)
- av share price (USD)
- balance at end of period

////

Fourthly, extreme contrivedness:
8. Travelling freighter problem

- do some reading
- convert C# example code to Resolver
- doc: represent all shipping lanes between ports as a graph of interconnected nodes, and do a "travelling freighter problem" solution of shortest route for a freighter to visit each port exactly once. provide a diagram on web.

particularly relevant:
http://code.msdn.microsoft.com/solverfoundation
http://blogs.msdn.com/natbr/archive/2009/04/27/solving-traveling-salesman-problems-using-solver-foundation.aspx
http://blogs.msdn.com/natbr/archive/2009/05/07/solver-foundation-tsp-part-ii-directives-solver-plugins-model-libraries.aspx
http://yetanothermathprogrammingconsultant.blogspot.com/2009/02/ms-solver-foundation-gurobi-2.html
http://yetanothermathprogrammingconsultant.blogspot.com/2009/02/tsp-powerset-formulation.html
http://archive.ite.journal.informs.org/Vol7No1/LeeRaffensperger/
http://blogs.msdn.com/lengningliu/archive/2009/11/04/using-solver-foundation-and-plug-in-solvers-in-ironpython.aspx
http://en.wikipedia.org/wiki/Travelling_salesman_problem
http://en.wikipedia.org/wiki/Priority_queue

also:
http://www.amsterdamoptimization.com/msf.html

///

9. sheet that calls AlgoServer with various combinations of parameters (diff lists, diff algorithms), doing each one for a large number of iterations, and gets returned data on time taken. for each alg includes avg/min/max creation time and avg/min/max sort time (creation time not always relevant, otherwise 'N/A). Mark winner for each category with red X.
add to uml deployment. 

///

General Resolver things to do:
Possibly some vaguely sensible management (decisions on when to reuse + close) of the db connection?

////

Database stuff (needs adding to both a) UML diagram and b) actual SQL scripts):
- maybe add some views for use by the various processes that need info from database?
- do some normalisation some time after the design has changed a bit, and doc how I carried this out, and doc what normal form the db is in
- make sure indexes, triggers, fks and pks (and their names), and constraints (and their names) match up UML <-> sql and vice versa
- error handling on error being returned on database query

- test data (or maybe just store some real data from system?):
INSERT INTO dbo.FuturesContract
           (TraderID, CommodityID, PortID, Price , Quantity, PurchaseTime, SettlementTime, ActualSetTime)
     VALUES
     ()
GO

INSERT INTO dbo.WarehousedCommodity
           (TraderID, CommodityID, PortID, FuturesContractID, Quantity, PurchasePrice, PurchaseTime, SaleTime, SalePrice, SalePortID)
     VALUES
     ()
GO

INSERT INTO dbo.CommodityTransport
           (ShippingCompanyID, WarehousedCommodityID, DepartureTime, ArrivalTime)
     VALUES
     ()
GO

later SQL stuff:
- Read database management systems chapters 19, 20, 21
- do some database normalisation and tuning, and security management
- faff about with different sorts of indexes etc, maybe also so totally pointless striping, clustering, etc
- doc optimization/tuning
other ideas:
- views
- stored procedures
- faff with permissions and security and security schemas

////

testing:
- unittest only bank can write to db
- make processes do right thing when other processes go down, and have automated tests for all possibilities if differing orders of collapse.
- unittest the algoriths and data structures service
- unittest multiheadqueue
- However multi-thread and multi-process concurrent aspects of program are not suited to normal unit testing frameworks. just write some sort of stress test script - i.e. start loads and loads of processes and look for obvious problems - including crashing and incorrect answers in data. Doc this (inc CV desc)
- database connections should be closed when no longer needed

- use stress test to try to find any bottlenecks that can be optimised away, and if I find any doc this (maybe inc CV desc).
- need to think of some way of checking that servers have not gone out of sync

////

UML diagrams:

Sequence:
- needs tidying up

SQL:
- add add spatial stuff, table inheritance stuff, correct trigger names
- once project is finished, make sure it matches up with actual schema
- stuff that should be kept in sync includes: add table inheritance stuff, triggers, constraints
- maybe make currency short name the key, or at least make unique
- rearrange to be more tidy

Deployment view:
- are protocol labels OK without being a proper sterotype?
- does anyone else access the db after start up?

////

algorithms bit:
following remote methods

CreateStructure()
args: which structure, list
returns: structure id, time taken

Time results from structure()
args: structureid
returns: structure id, time taken

Time results from sort alg()
args: method, list
returns: time taken

DeleteStructure
args: structure id
returns: success or failure

TimeMethod
method 2: 
1. enum of method to use 2. the list 3. whether to return

- using info both in algos book and database book, have an entirely pointless AlgoServer (including on UML diagram, with a note of explanation) that has functions to create various complex data structures and run various algorithms.

some examples:
- merge sort
- quick sort
- quick sort in place
- heap sort
- hash table
- red black tree
- b tree

It has two types of call, one returns the result, the other just returns how long the procedure took.

- start script for algoserver
- unit test
- does data contract require I use get/set properties? how exactly does data contract work?

///

doc:

One day the description here, description in index.htm, description on CV, and description in Wolfie will all need to be synced...

credit ppl from readme on web

The name is a nod to book Tai Pan, that is the general point is that there are several large trading houses which ferry various goods very long distances, though actually here the trading houses have been split into two distinct entities, the "Shipping companies" who do the actual transporting of goods, and the "traders" who predict surpluses and shortages in the market and buy and sell goods accordingly.

Mention how threads generally a bad idea, used as an exercise here, but in most real projects there are simpler, more reliable alternatives (i.e. asynchronous network read/writes, likely combined with callbacks for when data has finished sending or receiving, or otherwise combined with manual system of asynchronous acknowledgement messages between clients).

doc how even without 5 second delay in taking contracts for movements off broadcast, the multithreaded nature of system would mean it would be possible for two threads to simultaneously accept the same request anyway

- describe use of bank and db as mediator of many interactions in system, mention any other patterns used

shorter version for CV etc:

•	A C# .NET, SQL Server and Python project written to improve my knowledge of various aspects of computer science and software engineering. A large number of heterogeneous multithreaded C# processes interact with each other by sending and receiving messages via TCP sockets. These processes manipulate data using various algorithms and data structures for producing and manipulating sequences of numbers. Much of the underlying state of the system is stored in a MS SQL Server instance. A user interface to the system is provided in the form of an IronPython-based spreadsheet that performs simplistic mathematical modelling (with help from Microsoft Solver Foundation). The spreadsheet is also linked to a C# program for producing WPF graphs. The project also uses UML, unit testing, source control, etc. Around 200 hours work so far.


some phrases that could go in web doc:

The front end utilises the spreadsheet/Python "mash up" “Resolver One” to provide analysis of the real time data from the database. The Python spreadsheet uses Microsoft's Solver Foundation to solve a version of the Travelling Salesman Problem, and o provide xxx fixme for some of the stochastic outputs of the system. A local C# program is called by the spreadsheet script to produce realtime WPF graphs on same aspects of this analysis.

One final, especially contrived C# service uses WCF/SOAP to provide a network service that blah blah differing algorithms or data structures  blah blah spreadsheet integ

- lots of xmlcomments for classes and methods (methods only necessary for public classes)
- time spent graph (note on first point saying includes several weeks in one point)


